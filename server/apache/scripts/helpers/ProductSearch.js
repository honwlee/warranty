/**
 * warranty - 
 * @author 
 * @version v0.0.0
 * @link 
 * @license 
 */
define(["skylarkjs","server","./Partial","./itemActions","./formModal","toastr","jquery","handlebars"],function(e,t,n,i,r,a,o,c){var s=e.langx;return s.Evented.inherit({klassName:"ProductSearch",searchKey:null,doAction:!1,searchValue:null,init:function(e){e=e||{},this.doAction=e.doAction,this._buildDom()},search:function(e,n){var i=this;t().connect("products","get","show?"+n).then(function(t){e.find("#productData").empty(),t&&t.length>0?(t.forEach(function(t){i.fillItem(t,e)}),e.find(".no-result").addClass("hide"),e.find(".thanks").removeClass("hide")):(e.find(".thanks").addClass("hide"),e.find(".no-result").removeClass("hide")),i.trigger("searched")})},getPrepareData:function(){},fillItem:function(e,t){var s=this,d=t.find("#productData");i.productItem(d,e),n.get("item-action-partial");var l=c.compile("{{> item-action-partial}}");if(this.doAction){var u=o(l()).appendTo(d);u.find(".del-btn").on("click",function(){s.remove(warranty,function(){d.empty(),a.success("删除成功！")})}),u.find(".edit-btn").on("click",function(){r.show("product",e,function(e){s.fillItem(e,t)})})}},remove:function(e,t){i.removeProduct(e,t)},_buildDom:function(e){n.get("product-search-partial");var t=this,i=c.compile("{{> product-search-partial}}"),r=o("<div>").html(i()),s=this.selector=o(r[0].firstChild);t.searchKey=s.find("#productS").val(),s.find("#productS").on("change",function(){t.searchKey=this.value});var d=function(){var e=s.find("#prodValue").val();if(!t.searchKey)return a.warning("请选择查询选项！");if(!e)return a.warning("请填写查询值！");var n="key="+t.searchKey+"&value="+e;t.search(s,n),s.find(".panel-heading").removeClass("hide")};return s.find("#searchProductBtn").on("click",d),s.off("keypress").on("keypress",function(e){13===e.keyCode&&d()}),this.selector},getDom:function(){return this.selector}})});